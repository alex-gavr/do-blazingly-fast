---
import FinanceSurvey from '@components/FinanceSurvey/FinanceSurvey.astro';
import Layout from '@layouts/Layout.astro';
import NonUniqueV2Test from '@src/components/NonUnique/NonUniqueV2Test.astro';
import ShoppingSurvey from '@src/components/ShoppingSurvey/ShoppingSurvey.astro';
import { offers } from '@src/config';

const offer = parseInt(Astro.url.searchParams.get('offer_id') ?? '0');
const nonUniqueTest = Astro.url.searchParams.get('abtest');

const offerExists = offers.includes(offer as (typeof offers)[number]);
const nonUnique = Astro.cookies.get('nonUnique').value ?? false;
const nonUniqueTeen = Astro.cookies.get('nonUniqueTeen').value ?? false;
const nonUniqueDo = Astro.cookies.get('lead').value ?? false;
const nonUniqueTeenDo = Astro.cookies.get('lead-teenage').value ?? false;
const nonUniqueCrossDo = Astro.cookies.get('lead-cross').value ?? false;
const nonUniqueCrossTeenDo = Astro.cookies.get('lead-teenage-cross').value ?? false;
---

{
  (nonUnique && nonUniqueTest === '270769111') ||
  (nonUniqueDo && nonUniqueTest === '270769111') ||
  (nonUniqueTeenDo && nonUniqueTest === '270769111') ||
  (nonUniqueCrossDo && nonUniqueTest === '270769111') ||
  (nonUniqueCrossTeenDo && nonUniqueTest === '270769111') ||
  (nonUniqueTeen && nonUniqueTest === '270769111') ||
  (nonUnique && nonUniqueTest === '270769222') ||
  (nonUniqueDo && nonUniqueTest === '270769222') ||
  (nonUniqueTeenDo && nonUniqueTest === '270769222') ||
  (nonUniqueCrossDo && nonUniqueTest === '270769222') ||
  (nonUniqueCrossTeenDo && nonUniqueTest === '270769222') ||
  (nonUniqueTeen && nonUniqueTest === '270769222') ? (
    <NonUniqueV2Test />
  ) : (
    <Layout title='Best Survey in the world'>
      {offer === 0 || offer === 2025 || !offer || !offerExists ? <FinanceSurvey /> : null}
      {offer === 10864 ? <ShoppingSurvey /> : null}
    </Layout>
  )
}
